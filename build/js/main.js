"use strict";document.addEventListener("DOMContentLoaded",function(){var y=document.getElementsByClassName("knob__control")[0],L=document.getElementsByClassName("knob__value")[0],C=Array.from(document.getElementsByClassName("tick")),E=300,N=228,w=30,B=function(){for(var e=["transform","msTransform","webkitTransform","mozTransform","oTransform"],t=0;t<e.length;t++){var s=e[t];if(void 0!==document.body.style[s])return s}}();function o(e){return N=e&&N+2<=E?N+2:!e&&0<=N-2?N-2:N,function(){y.style[B]="rotate("+N+"deg)";var e=!0,t=!1,s=void 0;try{for(var o,n=C[Symbol.iterator]();!(e=(o=n.next()).done);e=!0){var a=o.value;a.classList.remove("active")}}catch(e){t=!0,s=e}finally{try{!e&&n.return&&n.return()}finally{if(t)throw s}}var r=Math.round(N/3-1);if(console.log(r),r<=0){var l=!0,i=!1,c=void 0;try{for(var m,d=C.slice(0,1)[Symbol.iterator]();!(l=(m=d.next()).done);l=!0){var v=m.value;v.classList.add("active")}}catch(e){i=!0,c=e}finally{try{!l&&d.return&&d.return()}finally{if(i)throw c}}}else{var f=!0,u=!1,g=void 0;try{for(var h,_=C.slice(0,r)[Symbol.iterator]();!(f=(h=_.next()).done);f=!0){var p=h.value;p.classList.add("active")}}catch(e){u=!0,g=e}finally{try{!f&&_.return&&_.return()}finally{if(u)throw g}}}L.innerHTML="+"+Math.ceil(w/100*Math.round(N/E*100))}()}var s=document.getElementsByClassName("knob")[0];s.onmousedown=function(e){var s=e.pageX;document.onmousemove=function(e){e.pageX>s?o(!0):o(!1),s=e.pageX;var t=document.getElementsByClassName("knob")[0];document.onmouseup=function(){document.onmousemove=null,t.onmouseup=null},y.ondragstart=function(){return!1}}},s.ontouchstart=function(e){var t=e.changedTouches[0].pageX;s.ontouchmove=function(e){e.changedTouches[0].pageX>t?o(!0):o(!1),t=e.changedTouches[0].pageX}}},!1),document.addEventListener("DOMContentLoaded",function(){for(var e=document.getElementsByClassName("device-filter__item"),t=0;t<e.length;t++)e[t].addEventListener("click",function(){var e=document.getElementsByClassName("device-filter__item");if(console.log(e),this.classList.contains("device-filter__item_active"))if(console.log("active"),console.log(this),this.classList.contains("device-filter__item_show")){console.log("true");for(var t=0;t<e.length;t++)e[t].classList.remove("device-filter__item_show")}else{console.log("false");for(t=0;t<e.length;t++)e[t].classList.add("device-filter__item_show")}else{document.getElementsByClassName("device-filter__item_active")[0].classList.remove("device-filter__item_active"),this.classList.add("device-filter__item_active");for(t=0;t<e.length;t++)e[t].classList.remove("device-filter__item_show")}})},!1),document.addEventListener("DOMContentLoaded",function(){for(var s=document.getElementsByClassName("modal-trigger"),e=function(t){s[t].addEventListener("click",function(){var e=String(s[t].getAttribute("data-modal"));document.getElementsByClassName(e)[0].classList.add("modal-wrap_active"),document.getElementsByClassName("wrap")[0].classList.add("blur"),document.body.style.overflow="hidden"})},t=0;t<s.length;t++)e(t)},!1);var container=void 0,step=void 0,promStep=void 0,nextPosition=void 0;function scrollNext(e,t){container=document.getElementsByClassName(e)[0],step=container.hasAttribute("offset")?container.clientWidth-parseInt(container.getAttribute("offset")):container.clientWidth,promStep=Math.ceil(container.scrollLeft/step),nextPosition=Number.isInteger(Math.ceil(container.scrollLeft)/step)?(promStep+1)*step:promStep*step,container.scrollLeft=nextPosition}function scrollPrev(e){container=document.getElementsByClassName(e)[0],step=container.hasAttribute("offset")?container.clientWidth-parseInt(container.getAttribute("offset")):container.clientWidth,promStep=Math.floor(container.scrollLeft/step),nextPosition=Number.isInteger(container.scrollLeft/step)?(promStep-1)*step:promStep*step,container.scrollLeft=nextPosition}function filterSelection(e){var t,s;for(t=document.getElementsByClassName("card_horisontal-filter"),"all"==e&&(e=""),s=0;s<t.length;s++)w3RemoveClass(t[s],"card_horisontal-filter-show"),-1<t[s].className.indexOf(e)&&w3AddClass(t[s],"card_horisontal-filter-show")}function w3AddClass(e,t){var s,o,n;for(o=e.className.split(" "),n=t.split(" "),s=0;s<n.length;s++)-1==o.indexOf(n[s])&&(e.className+=" "+n[s])}function w3RemoveClass(e,t){var s,o,n;for(o=e.className.split(" "),n=t.split(" "),s=0;s<n.length;s++)for(;-1<o.indexOf(n[s]);)o.splice(o.indexOf(n[s]),1);e.className=o.join(" ")}document.addEventListener("DOMContentLoaded",function(){for(var a=document.getElementsByClassName("scroll-block"),e=function(e){var t=a[e],s=Array.prototype.slice.call(document.getElementsByClassName(String(t.dataset.controls))),o=s[0].getElementsByClassName("scroll-control__next")[0].getElementsByClassName("svg-scroll-arrow")[0],n=s[0].getElementsByClassName("scroll-control__prev")[0].getElementsByClassName("svg-scroll-arrow")[0];t.scrollWidth==t.clientWidth&&s[0].remove(),a[e].onscroll=function(){this.scrollWidth==this.scrollLeft+this.clientWidth?(o.classList.remove("svg-scroll-arrow_active"),n.classList.add("svg-scroll-arrow_active")):0==this.scrollLeft?(o.classList.add("svg-scroll-arrow_active"),n.classList.remove("svg-scroll-arrow_active")):(o.classList.add("svg-scroll-arrow_active"),n.classList.add("svg-scroll-arrow_active"))}},t=0;t<a.length;t++)e(t);document.getElementsByClassName("favor-cards")[0].onscroll=function(){var e=document.getElementsByClassName("arrow-reminder")[0];0==this.scrollTop?e.classList.remove("arrow-reminder_inactive"):e.classList.add("arrow-reminder_inactive")}},!1),filterSelection("all"),document.addEventListener("DOMContentLoaded",function(){for(var e=document.getElementsByClassName("select-filter__item"),t=0;t<e.length;t++)e[t].addEventListener("click",function(){this.parentElement.getElementsByClassName("select-filter__item_active")[0].classList.remove("select-filter__item_active"),this.classList.add("select-filter__item_active")})},!1);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImtub2IuanMiLCJtb2JpbGUtc2VsZWN0LmpzIiwibW9kYWwuanMiLCJzY3JvbGwuanMiLCJzZWxlY3QuanMiXSwibmFtZXMiOlsiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwia25vYiIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJjdXJyIiwidGlja3MiLCJBcnJheSIsImZyb20iLCJtYXgiLCJhbmdsZSIsIm1heHRlbXAiLCJ0cmFuc2Zvcm0iLCJfYXJyIiwiX2kiLCJsZW5ndGgiLCJwcm9wIiwiYm9keSIsInN0eWxlIiwidHVybnRVcCIsImJvb2wiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uIiwiX2RpZEl0ZXJhdG9yRXJyb3IiLCJfaXRlcmF0b3JFcnJvciIsInVuZGVmaW5lZCIsIl9zdGVwIiwiX2l0ZXJhdG9yIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJuZXh0IiwiZG9uZSIsInRpY2siLCJ2YWx1ZSIsImNsYXNzTGlzdCIsInJlbW92ZSIsImVyciIsInJldHVybiIsImFjdGl2ZXMiLCJNYXRoIiwicm91bmQiLCJjb25zb2xlIiwibG9nIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIiLCJfZGlkSXRlcmF0b3JFcnJvcjIiLCJfaXRlcmF0b3JFcnJvcjIiLCJfc3RlcDIiLCJfaXRlcmF0b3IyIiwic2xpY2UiLCJfdGljayIsImFkZCIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zIiwiX2RpZEl0ZXJhdG9yRXJyb3IzIiwiX2l0ZXJhdG9yRXJyb3IzIiwiX3N0ZXAzIiwiX2l0ZXJhdG9yMyIsIl90aWNrMiIsImlubmVySFRNTCIsImNlaWwiLCJzZXRBbmdsZSIsImtub2JhcmVhIiwib25tb3VzZWRvd24iLCJlIiwic3RhcnQiLCJwYWdlWCIsIm9ubW91c2Vtb3ZlIiwib25tb3VzZXVwIiwib25kcmFnc3RhcnQiLCJvbnRvdWNoc3RhcnQiLCJjaGFuZ2VkVG91Y2hlcyIsIm9udG91Y2htb3ZlIiwiYnRucyIsImkiLCJzaG93aXRlbXMiLCJ0aGlzIiwiY29udGFpbnMiLCJkIiwidHJpZ2dlcnMiLCJfbG9vcCIsIm1vZGFsQ2xhc3MiLCJTdHJpbmciLCJnZXRBdHRyaWJ1dGUiLCJvdmVyZmxvdyIsImNvbnRhaW5lciIsInN0ZXAiLCJwcm9tU3RlcCIsIm5leHRQb3NpdGlvbiIsInNjcm9sbE5leHQiLCJibG9jayIsImVsZW0iLCJoYXNBdHRyaWJ1dGUiLCJjbGllbnRXaWR0aCIsInBhcnNlSW50Iiwic2Nyb2xsTGVmdCIsIk51bWJlciIsImlzSW50ZWdlciIsInNjcm9sbFByZXYiLCJmbG9vciIsImZpbHRlclNlbGVjdGlvbiIsImMiLCJ4IiwidzNSZW1vdmVDbGFzcyIsImNsYXNzTmFtZSIsImluZGV4T2YiLCJ3M0FkZENsYXNzIiwiZWxlbWVudCIsIm5hbWUiLCJhcnIxIiwiYXJyMiIsInNwbGl0Iiwic3BsaWNlIiwiam9pbiIsInNjcm9sbEJsb2NrcyIsInNjcm9sbEJsb2NrIiwiY29udHJvbHMiLCJwcm90b3R5cGUiLCJjYWxsIiwiZGF0YXNldCIsInByZXYiLCJzY3JvbGxXaWR0aCIsIm9uc2Nyb2xsIiwicmVtaW5kZXIiLCJzY3JvbGxUb3AiLCJwYXJlbnRFbGVtZW50Il0sIm1hcHBpbmdzIjoiQUFBQSxhQUVBQSxTQUFBQyxpQkFBQSxtQkFBQSxXQUVBLElBQUFDLEVBQUFGLFNBQUFHLHVCQUFBLGlCQUFBLEdBQ0FDLEVBQUFKLFNBQUFHLHVCQUFBLGVBQUEsR0FDQUUsRUFBQUMsTUFBQUMsS0FBQVAsU0FBQUcsdUJBQUEsU0FHQUssRUFBQSxJQUNBQyxFQUFBLElBQ0FDLEVBQUEsR0FDQUMsRUFBQSxXQUdBLElBRkEsSUFBQUMsRUFBQSxDQUFBLFlBQUEsY0FBQSxrQkFBQSxlQUFBLGNBRUFDLEVBQUEsRUFBQUEsRUFBQUQsRUFBQUUsT0FBQUQsSUFBQSxDQUNBLElBQUFFLEVBQUFILEVBQUFDLEdBQ0EsUUFBQSxJQUFBYixTQUFBZ0IsS0FBQUMsTUFBQUYsR0FDQSxPQUFBQSxHQU5BLEdBV0EsU0FBQUcsRUFBQUMsR0FF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V0FDQSxJQUFBQyxFQUFBdkgsU0FBQUcsdUJBQUEsa0JBQUEsR0FDQSxHQUFBcUUsS0FBQWdELFVBQ0FELEVBQUF2RixVQUFBQyxPQUFBLDJCQUVBc0YsRUFBQXZGLFVBQUFnQixJQUFBLDhCQUtBLEdDdkZBZ0QsZ0JBQUEsT0FzQ0FoRyxTQUFBQyxpQkFBQSxtQkFBQSxXQUVBLElBREEsSUFBQW9FLEVBQUFyRSxTQUFBRyx1QkFBQSx1QkFDQW1FLEVBQUEsRUFBQUEsRUFBQUQsRUFBQXZELE9BQUF3RCxJQUNBRCxFQUFBQyxHQUFBckUsaUJBQUEsUUFBQSxXQUNBdUUsS0FBQWlELGNBQUF0SCx1QkFBQSw4QkFBQSxHQUFBNkIsVUFBQUMsT0FBQSw4QkFDQXVDLEtBQUF4QyxVQUFBZ0IsSUFBQSxrQ0FHQSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuXG4gICAgdmFyIGtub2IgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdrbm9iX19jb250cm9sJylbMF07XG4gICAgdmFyIGN1cnIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdrbm9iX192YWx1ZScpWzBdO1xuICAgIHZhciB0aWNrcyA9IEFycmF5LmZyb20oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGljaycpKTtcblxuICAgIHZhciBtaW4gPSAwO1xuICAgIHZhciBtYXggPSAzMDA7XG4gICAgdmFyIGFuZ2xlID0gMjI4O1xuICAgIHZhciBtYXh0ZW1wID0gMzA7XG4gICAgdmFyIHRyYW5zZm9ybSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9hcnIgPSBbJ3RyYW5zZm9ybScsICdtc1RyYW5zZm9ybScsICd3ZWJraXRUcmFuc2Zvcm0nLCAnbW96VHJhbnNmb3JtJywgJ29UcmFuc2Zvcm0nXTtcblxuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgX2Fyci5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBwcm9wID0gX2FycltfaV07XG4gICAgICAgICAgICBpZiAodHlwZW9mIGRvY3VtZW50LmJvZHkuc3R5bGVbcHJvcF0gIT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0oKTtcblxuICAgIGZ1bmN0aW9uIHR1cm50VXAoYm9vbCkge1xuICAgICAgICBhbmdsZSA9IGJvb2wgJiYgYW5nbGUgKyAyIDw9IG1heCA/IGFuZ2xlICsgMiA6ICFib29sICYmIGFuZ2xlIC0gMiA+PSBtaW4gPyBhbmdsZSAtIDIgOiBhbmdsZTtcbiAgICAgICAgcmV0dXJuIHNldEFuZ2xlKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0QW5nbGUoKSB7XG4gICAgICAgIC8vIHJvdGF0ZSBrbm9iXG4gICAgICAgIGtub2Iuc3R5bGVbdHJhbnNmb3JtXSA9ICdyb3RhdGUoJyArIGFuZ2xlICsgJ2RlZyknO1xuXG4gICAgICAgIC8vIHF1aWNrbHkgcmVzZXQgdGlja3NcbiAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlO1xuICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSB0aWNrc1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGljayA9IF9zdGVwLnZhbHVlO1xuXG4gICAgICAgICAgICAgICAgdGljay5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWRkIGdsb3cgdG8gJ2FjdGl2ZScgdGlja3NcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7XG4gICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IGVycjtcbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvci5yZXR1cm4pIHtcbiAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yLnJldHVybigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBhY3RpdmVzID0gTWF0aC5yb3VuZChhbmdsZSAvIDMgLSAxKTtcbiAgICAgICAgY29uc29sZS5sb2coYWN0aXZlcyk7XG4gICAgICAgIGlmIChhY3RpdmVzIDw9IDApIHtcbiAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWU7XG4gICAgICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IyID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IyID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSB0aWNrcy5zbGljZSgwLCAxKVtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMjsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IChfc3RlcDIgPSBfaXRlcmF0b3IyLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX3RpY2sgPSBfc3RlcDIudmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgX3RpY2suY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IyID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvcjIgPSBlcnI7XG4gICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgJiYgX2l0ZXJhdG9yMi5yZXR1cm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIucmV0dXJuKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMyA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yMyA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IzID0gdGlja3Muc2xpY2UoMCwgYWN0aXZlcylbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDM7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMgPSAoX3N0ZXAzID0gX2l0ZXJhdG9yMy5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF90aWNrMiA9IF9zdGVwMy52YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICBfdGljazIuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvcjMgPSBlcnI7XG4gICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMgJiYgX2l0ZXJhdG9yMy5yZXR1cm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjMucmV0dXJuKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyB1cGRhdGUgJSB2YWx1ZSBhcyB0ZXh0XG4gICAgICAgIGN1cnIuaW5uZXJIVE1MID0gJysnICsgTWF0aC5jZWlsKG1heHRlbXAgLyAxMDAgKiBNYXRoLnJvdW5kKGFuZ2xlIC8gbWF4ICogMTAwKSk7XG4gICAgfVxuXG4gICAgdmFyIGtub2JhcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgna25vYicpWzBdO1xuXG4gICAga25vYmFyZWEub25tb3VzZWRvd24gPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAvLyAxLiDQvtGC0YHQu9C10LTQuNGC0Ywg0L3QsNC20LDRgtC40LVcbiAgICAgICAgdmFyIHN0YXJ0ID0gZS5wYWdlWDtcbiAgICAgICAgZG9jdW1lbnQub25tb3VzZW1vdmUgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgICAgICAgICBpZiAoZS5wYWdlWCA+IHN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgdHVybnRVcCh0cnVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdHVybnRVcChmYWxzZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN0YXJ0ID0gZS5wYWdlWDtcbiAgICAgICAgICAgIHZhciBrbm9iYXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2tub2InKVswXTtcbiAgICAgICAgICAgIGRvY3VtZW50Lm9ubW91c2V1cCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5vbm1vdXNlbW92ZSA9IG51bGw7XG4gICAgICAgICAgICAgICAga25vYmFyZWEub25tb3VzZXVwID0gbnVsbDtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGtub2Iub25kcmFnc3RhcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAga25vYmFyZWEub250b3VjaHN0YXJ0ID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWDtcbiAgICAgICAga25vYmFyZWEub250b3VjaG1vdmUgPSBmdW5jdGlvbiAoZSkge1xuXG4gICAgICAgICAgICBpZiAoZS5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWCA+IHN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgdHVybnRVcCh0cnVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdHVybnRVcChmYWxzZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN0YXJ0ID0gZS5jaGFuZ2VkVG91Y2hlc1swXS5wYWdlWDtcbiAgICAgICAgfTsgLy8gICBhbGVydChlLmNoYW5nZWRUb3VjaGVzWzBdLnBhZ2VYKSAvLyDQv9C+0LrQsNC3INC60L7RgNGA0LTQuNC90LDRgiDQvNC10YHRgtCwINC/0YDQuNC60L7RgdC90L7QstC10L3QuNGPINC/0L4gWC3Rgy5cbiAgICB9O1xufSwgZmFsc2UpO1xuXG4vLyBmdW5jdGlvbiBnZXRDdXJDb29yZHNJbnNpZGVSZWN0KGUpIHtcbi8vICAgICB2YXIgeCA9IGUub2Zmc2V0WCA9PSB1bmRlZmluZWQgPyBlLmxheWVyWCA6IGUub2Zmc2V0WDtcbi8vICAgICB2YXIgeSA9IGUub2Zmc2V0WSA9PSB1bmRlZmluZWQgPyBlLmxheWVyWSA6IGUub2Zmc2V0WTtcblxuLy8gICAgIGFsZXJ0KHggKyAneCcgKyB5KTtcbi8vIH1cblxuLy8gZnVuY3Rpb24gZ2V0RWxlbWVudChlLCBlbGVtZW50KSB7XG4vLyAgICAgZ2V0Q3VyQ29vcmRzSW5zaWRlUmVjdChlLCBlbGVtZW50KTtcbi8vIH0iLCJcInVzZSBzdHJpY3RcIjtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYnRucyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJkZXZpY2UtZmlsdGVyX19pdGVtXCIpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnRucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBidG5zW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc2hvd2l0ZW1zID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImRldmljZS1maWx0ZXJfX2l0ZW1cIik7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzaG93aXRlbXMpO1xuICAgICAgICAgICAgaWYgKHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZGV2aWNlLWZpbHRlcl9faXRlbV9hY3RpdmVcIikpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnYWN0aXZlJyk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhpcyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZGV2aWNlLWZpbHRlcl9faXRlbV9zaG93XCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidHJ1ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IDA7IGQgPCBzaG93aXRlbXMubGVuZ3RoOyBkKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dpdGVtc1tkXS5jbGFzc0xpc3QucmVtb3ZlKFwiZGV2aWNlLWZpbHRlcl9faXRlbV9zaG93XCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJmYWxzZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgZCA9IDA7IGQgPCBzaG93aXRlbXMubGVuZ3RoOyBkKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3dpdGVtc1tkXS5jbGFzc0xpc3QuYWRkKFwiZGV2aWNlLWZpbHRlcl9faXRlbV9zaG93XCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiZGV2aWNlLWZpbHRlcl9faXRlbV9hY3RpdmVcIilbMF0uY2xhc3NMaXN0LnJlbW92ZShcImRldmljZS1maWx0ZXJfX2l0ZW1fYWN0aXZlXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LmFkZChcImRldmljZS1maWx0ZXJfX2l0ZW1fYWN0aXZlXCIpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGQgPSAwOyBkIDwgc2hvd2l0ZW1zLmxlbmd0aDsgZCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHNob3dpdGVtc1tkXS5jbGFzc0xpc3QucmVtb3ZlKFwiZGV2aWNlLWZpbHRlcl9faXRlbV9zaG93XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufSwgZmFsc2UpOyIsIid1c2Ugc3RyaWN0JztcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdHJpZ2dlcnMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdtb2RhbC10cmlnZ2VyJyk7XG5cbiAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcChpKSB7XG4gICAgICAgIHRyaWdnZXJzW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgbW9kYWxDbGFzcyA9IFN0cmluZyh0cmlnZ2Vyc1tpXS5nZXRBdHRyaWJ1dGUoJ2RhdGEtbW9kYWwnKSk7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKG1vZGFsQ2xhc3MpWzBdLmNsYXNzTGlzdC5hZGQoJ21vZGFsLXdyYXBfYWN0aXZlJyk7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd3cmFwJylbMF0uY2xhc3NMaXN0LmFkZCgnYmx1cicpO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiaGlkZGVuXCI7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRyaWdnZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIF9sb29wKGkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsb3NlTW9kYWwoKSB7XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ21vZGFsLXdyYXBfYWN0aXZlJylbMF0uY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWwtd3JhcF9hY3RpdmUnKTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYmx1cicpWzBdLmNsYXNzTGlzdC5yZW1vdmUoJ2JsdXInKTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9IFwiYXV0b1wiO1xuICAgIH1cblxuICAgIHZhciBrZXlzID0geyAzNzogMSwgMzg6IDEsIDM5OiAxLCA0MDogMSB9O1xuXG4gICAgZnVuY3Rpb24gcHJldmVudERlZmF1bHQoZSkge1xuICAgICAgICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG4gICAgICAgIGlmIChlLnByZXZlbnREZWZhdWx0KSBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUucmV0dXJuVmFsdWUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwcmV2ZW50RGVmYXVsdEZvclNjcm9sbEtleXMoZSkge1xuICAgICAgICBpZiAoa2V5c1tlLmtleUNvZGVdKSB7XG4gICAgICAgICAgICBwcmV2ZW50RGVmYXVsdChlKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbn0sIGZhbHNlKTsiLCIndXNlIHN0cmljdCc7XG5cbnZhciBjb250YWluZXIgPSB2b2lkIDA7XG52YXIgc3RlcCA9IHZvaWQgMDtcbnZhciBwcm9tU3RlcCA9IHZvaWQgMDtcbnZhciBuZXh0UG9zaXRpb24gPSB2b2lkIDA7XG5cbmZ1bmN0aW9uIHNjcm9sbE5leHQoYmxvY2ssIGVsZW0pIHtcblxuICAgIGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoYmxvY2spWzBdO1xuXG4gICAgaWYgKGNvbnRhaW5lci5oYXNBdHRyaWJ1dGUoJ29mZnNldCcpKSB7XG4gICAgICAgIHN0ZXAgPSBjb250YWluZXIuY2xpZW50V2lkdGggLSBwYXJzZUludChjb250YWluZXIuZ2V0QXR0cmlidXRlKCdvZmZzZXQnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc3RlcCA9IGNvbnRhaW5lci5jbGllbnRXaWR0aDtcbiAgICB9XG4gICAgcHJvbVN0ZXAgPSBNYXRoLmNlaWwoY29udGFpbmVyLnNjcm9sbExlZnQgLyBzdGVwKTtcblxuICAgIGlmIChOdW1iZXIuaXNJbnRlZ2VyKE1hdGguY2VpbChjb250YWluZXIuc2Nyb2xsTGVmdCkgLyBzdGVwKSkge1xuICAgICAgICBuZXh0UG9zaXRpb24gPSAocHJvbVN0ZXAgKyAxKSAqIHN0ZXA7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbmV4dFBvc2l0aW9uID0gcHJvbVN0ZXAgKiBzdGVwO1xuICAgIH1cblxuICAgIGNvbnRhaW5lci5zY3JvbGxMZWZ0ID0gbmV4dFBvc2l0aW9uO1xufTtcblxuZnVuY3Rpb24gc2Nyb2xsUHJldihibG9jaykge1xuXG4gICAgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShibG9jaylbMF07XG5cbiAgICBpZiAoY29udGFpbmVyLmhhc0F0dHJpYnV0ZSgnb2Zmc2V0JykpIHtcbiAgICAgICAgc3RlcCA9IGNvbnRhaW5lci5jbGllbnRXaWR0aCAtIHBhcnNlSW50KGNvbnRhaW5lci5nZXRBdHRyaWJ1dGUoJ29mZnNldCcpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBzdGVwID0gY29udGFpbmVyLmNsaWVudFdpZHRoO1xuICAgIH1cbiAgICBwcm9tU3RlcCA9IE1hdGguZmxvb3IoY29udGFpbmVyLnNjcm9sbExlZnQgLyBzdGVwKTtcbiAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcihjb250YWluZXIuc2Nyb2xsTGVmdCAvIHN0ZXApKSB7XG4gICAgICAgIG5leHRQb3NpdGlvbiA9IChwcm9tU3RlcCAtIDEpICogc3RlcDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBuZXh0UG9zaXRpb24gPSBwcm9tU3RlcCAqIHN0ZXA7XG4gICAgfVxuXG4gICAgY29udGFpbmVyLnNjcm9sbExlZnQgPSBuZXh0UG9zaXRpb247XG59O1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuICAgIHZhciBzY3JvbGxCbG9ja3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdzY3JvbGwtYmxvY2snKTtcblxuICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKGkpIHtcbiAgICAgICAgdmFyIHNjcm9sbEJsb2NrID0gc2Nyb2xsQmxvY2tzW2ldO1xuICAgICAgICB2YXIgY29udHJvbHMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFN0cmluZyhzY3JvbGxCbG9jay5kYXRhc2V0LmNvbnRyb2xzKSkpO1xuICAgICAgICB2YXIgbmV4dCA9IGNvbnRyb2xzWzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3Njcm9sbC1jb250cm9sX19uZXh0JylbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc3ZnLXNjcm9sbC1hcnJvdycpWzBdO1xuICAgICAgICB2YXIgcHJldiA9IGNvbnRyb2xzWzBdLmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3Njcm9sbC1jb250cm9sX19wcmV2JylbMF0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc3ZnLXNjcm9sbC1hcnJvdycpWzBdO1xuICAgICAgICBpZiAoc2Nyb2xsQmxvY2suc2Nyb2xsV2lkdGggPT0gc2Nyb2xsQmxvY2suY2xpZW50V2lkdGgpIHtcbiAgICAgICAgICAgIGNvbnRyb2xzWzBdLnJlbW92ZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2Nyb2xsQmxvY2tzW2ldLm9uc2Nyb2xsID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAvLyBsZXQgZWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2Zhdm9yLWRldmljZXMnKVswXVxuICAgICAgICAgICAgaWYgKHRoaXMuc2Nyb2xsV2lkdGggPT0gdGhpcy5zY3JvbGxMZWZ0ICsgdGhpcy5jbGllbnRXaWR0aCkge1xuICAgICAgICAgICAgICAgIG5leHQuY2xhc3NMaXN0LnJlbW92ZSgnc3ZnLXNjcm9sbC1hcnJvd19hY3RpdmUnKTtcbiAgICAgICAgICAgICAgICBwcmV2LmNsYXNzTGlzdC5hZGQoJ3N2Zy1zY3JvbGwtYXJyb3dfYWN0aXZlJyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2Nyb2xsTGVmdCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgbmV4dC5jbGFzc0xpc3QuYWRkKCdzdmctc2Nyb2xsLWFycm93X2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgIHByZXYuY2xhc3NMaXN0LnJlbW92ZSgnc3ZnLXNjcm9sbC1hcnJvd19hY3RpdmUnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV4dC5jbGFzc0xpc3QuYWRkKCdzdmctc2Nyb2xsLWFycm93X2FjdGl2ZScpO1xuICAgICAgICAgICAgICAgIHByZXYuY2xhc3NMaXN0LmFkZCgnc3ZnLXNjcm9sbC1hcnJvd19hY3RpdmUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzY3JvbGxCbG9ja3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgX2xvb3AoaSk7XG4gICAgfVxuXG4gICAgLy8g0J/QvtC60LDQt9GL0LLQsNC10Lwg0LjQu9C4INGD0LHQuNGA0LDQtdC8INGB0YLRgNC10LvQutGDIC0g0L3QsNC/0L7QvNC40L3QsNC70LrRgyDQsiDQs9C70LDQstC90L7QvCDQsdC70L7QutC1XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZmF2b3ItY2FyZHMnKVswXS5vbnNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlbWluZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYXJyb3ctcmVtaW5kZXInKVswXTtcbiAgICAgICAgaWYgKHRoaXMuc2Nyb2xsVG9wID09IDApIHtcbiAgICAgICAgICAgIHJlbWluZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2Fycm93LXJlbWluZGVyX2luYWN0aXZlJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZW1pbmRlci5jbGFzc0xpc3QuYWRkKCdhcnJvdy1yZW1pbmRlcl9pbmFjdGl2ZScpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIGVsZW0uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc3ZnLXNjcm9sbC1hcnJvdycpWzBdLnJlbW92ZSgnc2Nyb2xsLWNvbnRyb2xfYWN0aXZlJyk7XG59LCBmYWxzZSk7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbmZpbHRlclNlbGVjdGlvbihcImFsbFwiKTtcblxuZnVuY3Rpb24gZmlsdGVyU2VsZWN0aW9uKGMpIHtcbiAgICB2YXIgeCwgaTtcbiAgICB4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcImNhcmRfaG9yaXNvbnRhbC1maWx0ZXJcIik7XG4gICAgaWYgKGMgPT0gXCJhbGxcIikgYyA9IFwiXCI7XG4gICAgLy8gQWRkIHRoZSBcImNhcmRfaG9yaXNvbnRhbC1maWx0ZXItc2hvd1wiIGNsYXNzIChkaXNwbGF5OmJsb2NrKSB0byB0aGUgZmlsdGVyZWQgZWxlbWVudHMsIGFuZCByZW1vdmUgdGhlIFwiY2FyZF9ob3Jpc29udGFsLWZpbHRlci1zaG93XCIgY2xhc3MgZnJvbSB0aGUgZWxlbWVudHMgdGhhdCBhcmUgbm90IHNlbGVjdGVkXG4gICAgZm9yIChpID0gMDsgaSA8IHgubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdzNSZW1vdmVDbGFzcyh4W2ldLCBcImNhcmRfaG9yaXNvbnRhbC1maWx0ZXItc2hvd1wiKTtcbiAgICAgICAgaWYgKHhbaV0uY2xhc3NOYW1lLmluZGV4T2YoYykgPiAtMSkgdzNBZGRDbGFzcyh4W2ldLCBcImNhcmRfaG9yaXNvbnRhbC1maWx0ZXItc2hvd1wiKTtcbiAgICB9XG59XG5cbi8vIGNhcmRfaG9yaXNvbnRhbC1maWx0ZXItc2hvdyBmaWx0ZXJlZCBlbGVtZW50c1xuZnVuY3Rpb24gdzNBZGRDbGFzcyhlbGVtZW50LCBuYW1lKSB7XG4gICAgdmFyIGksIGFycjEsIGFycjI7XG4gICAgYXJyMSA9IGVsZW1lbnQuY2xhc3NOYW1lLnNwbGl0KFwiIFwiKTtcbiAgICBhcnIyID0gbmFtZS5zcGxpdChcIiBcIik7XG4gICAgZm9yIChpID0gMDsgaSA8IGFycjIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGFycjEuaW5kZXhPZihhcnIyW2ldKSA9PSAtMSkge1xuICAgICAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgKz0gXCIgXCIgKyBhcnIyW2ldO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vLyBIaWRlIGVsZW1lbnRzIHRoYXQgYXJlIG5vdCBzZWxlY3RlZFxuZnVuY3Rpb24gdzNSZW1vdmVDbGFzcyhlbGVtZW50LCBuYW1lKSB7XG4gICAgdmFyIGksIGFycjEsIGFycjI7XG4gICAgYXJyMSA9IGVsZW1lbnQuY2xhc3NOYW1lLnNwbGl0KFwiIFwiKTtcbiAgICBhcnIyID0gbmFtZS5zcGxpdChcIiBcIik7XG4gICAgZm9yIChpID0gMDsgaSA8IGFycjIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgd2hpbGUgKGFycjEuaW5kZXhPZihhcnIyW2ldKSA+IC0xKSB7XG4gICAgICAgICAgICBhcnIxLnNwbGljZShhcnIxLmluZGV4T2YoYXJyMltpXSksIDEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsZW1lbnQuY2xhc3NOYW1lID0gYXJyMS5qb2luKFwiIFwiKTtcbn1cblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYnRucyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJzZWxlY3QtZmlsdGVyX19pdGVtXCIpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnRucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBidG5zW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInNlbGVjdC1maWx0ZXJfX2l0ZW1fYWN0aXZlXCIpWzBdLmNsYXNzTGlzdC5yZW1vdmUoXCJzZWxlY3QtZmlsdGVyX19pdGVtX2FjdGl2ZVwiKTtcbiAgICAgICAgICAgIHRoaXMuY2xhc3NMaXN0LmFkZChcInNlbGVjdC1maWx0ZXJfX2l0ZW1fYWN0aXZlXCIpO1xuICAgICAgICB9KTtcbiAgICB9XG59LCBmYWxzZSk7Il19
